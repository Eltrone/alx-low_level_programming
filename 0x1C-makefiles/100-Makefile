# Makefile avancé qui respecte des contraintes spécifiques

NAME := school
CC := gcc
SRC := $(wildcard *.c)
OBJ := $(SRC:.c=.o)
CFLAGS := -Wall -Werror -Wextra -pedantic

# Règle principale pour construire l'exécutable
all: $(NAME)

# Compilation de l'exécutable sans utiliser directement $(CFLAGS) ni $(CC) plus d'une fois
$(NAME): $(OBJ)
	$(CC) $(OBJ) -o $(NAME)

# Compilation des fichiers objets sans définir une règle %.o: %.c
$(SRC:.c=.o): $(SRC) m.h
	$(CC) -c $(SRC)

# Nettoyage des fichiers temporaires
clean:
	/bin/rm -f *~ 

# Suppression des fichiers objets
oclean:
	/bin/rm -f $(OBJ)

# Nettoyage complet: fichiers temporaires, exécutables et objets
fclean: clean oclean
	/bin/rm -f $(NAME)

# Forcer la recompilation de tout
re: fclean all

# Déclarations pour éviter les conflits avec des fichiers du même nom
.PHONY: all clean fclean oclean re
